<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <title>Resumen Comercial</title>
    <?!= HtmlService.createHtmlOutputFromFile("Estilos").getContent(); ?>
</head>

<body>
    <div class="barraTopComercial">
        <div class="topBarra-izquierda">
            <? var url = getScriptUrl(); ?>
            <a href='<?= url ?>?page=Modulos' class="retornarModulos iconoTopBarra">M√≥dulos</a>
            <h1>Resumen de Cotizaciones</h1>
        </div>
        </div>

    <div class="contenedorModulos">
        <div class="card">

            <div class="header-resumen-con-paginacion">
                
                <div class="header-fila-superior">
                     <button onclick="abrirNuevoPedido()" class="boton-nuevo-pedido btn-base btn-success">
                        ‚ûï Nueva Cotizaci√≥n
                     </button>
                     <div class="search-container">
                         <input type="text" id="filtroPedidos" placeholder="Buscar..."
                                style="padding: 6px 10px; width: 300px; border: 1px solid #ccc; border-radius: 4px; font-size: 0.9em;">
                     </div>
                </div>

                <div class="header-fila-inferior">
                    <h2>Lista de Cotizaciones Registradas</h2>
                    <div class="paginacion-controles-simple">
                         <select id="filasPorPagina" onchange="cambiarFilasPorPagina()" title="Filas por p√°gina" style="padding: 4px; font-size: 0.9em; margin-right: 15px;">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="80" selected>80</option>
                            <option value="100">100</option>
                         </select>
                         <span id="infoPagina" class="info-pagina-simple"></span>
                         <button id="btnAnterior" onclick="cambiarPagina(-1)" class="btn-paginacion" title="Anterior" disabled>&lt;</button>
                         <button id="btnSiguiente" onclick="cambiarPagina(1)" class="btn-paginacion" title="Siguiente" disabled>&gt;</button>
                    </div>
                </div>
            </div>
            <div class="tabla-contenedor-scroll">
                <table id="tablaResumen" class="tabla-resumen tabla-scroll">
                    <thead>
                        <tr>
                            <th onclick="ordenarTabla(0, 'texto')">N¬∞ PEDIDO <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(1, 'fecha')">FECHA <span class="sort-icon"></span></th>
                            <th style="min-width: 150px;" onclick="ordenarTabla(2, 'texto')">CLIENTE <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(3, 'texto')">VENDEDOR <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(4, 'texto')">COMPA√ë√çA <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(5, 'numero')">MONTO TOTAL <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(6, 'texto')">MONEDA <span class="sort-icon"></span></th>
                            <th onclick="ordenarTabla(7, 'texto')">ESTADO <span class="sort-icon"></span></th>
                            <th>ACCI√ìN</th>
                            <th class="col-pdf">PDF</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpoTablaResumen">
                        <tr>
                            <td colspan="10" style="text-align: center; padding: 20px;"> Cargando datos...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div> </div> <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        </div>

<script>
    console.log("üîó Script URL obtenida:", '<?!= getScriptUrl() ?>');
    // Variables globales
    let datosCotizaciones = [];

    // =============================================================================
    // FUNCIONES UNIFICADAS Y OPTIMIZADAS
    // =============================================================================

    // Configuraci√≥n global (El √≠ndice ROW_INDEX es la √∫ltima columna del array de 8 columnas)
    const CONFIG = {
    columnas: { 
        NUM_PEDIDO: 0, FECHA: 1, CLIENTE: 2, VENDEDOR: 3, COMPANIA: 4,
        MONTO: 5, MONEDA: 6, ESTADO: 7, ID_CLIENTE: 8, ROW_INDEX: 9 
    }
};

    // Funci√≥n unificada para llamadas a Google Apps Script
    async function ejecutarGAS(funcion, parametros = null) {
        mostrarLoading(true, `Ejecutando ${funcion}...`);
        
        return new Promise((resolve, reject) => {
            const llamada = google.script.run
                .withSuccessHandler(resultado => {
                    mostrarLoading(false);
                    resolve(resultado);
                })
                .withFailureHandler(error => {
                    mostrarLoading(false);
                    console.error(`Error en ${funcion}:`, error);
                    alert(`‚ùå Error al ejecutar ${funcion}: ${error.message || error}`);
                    reject(error);
                });
                
            parametros ? llamada[funcion](parametros) : llamada[funcion]();
        });
    }

    // Funci√≥n unificada para navegaci√≥n
    function navegarA(pagina, parametros = {}) {
        const urlBase = '<?!= getScriptUrl() ?>';
        const parametrosURL = new URLSearchParams(parametros).toString();
        const urlCompleta = `${urlBase}?page=${pagina}${parametrosURL ? '&' + parametrosURL : ''}`;
        
        window.open(urlCompleta, '_blank');
    }

    // =============================================================================
    // FUNCIONES DE INICIALIZACI√ìN Y RENDERIZADO
    // =============================================================================

    document.addEventListener("DOMContentLoaded", function() {
        console.log("üîÑ ResumenComercial.html CARGADO");
        cargarDatosResumen();
        
        // Configurar filtro
        document.getElementById("filtroPedidos").addEventListener("input", filtrarPedidos);
    });

    async function cargarDatosResumen() {
        try {
            // Esta llamada activa la funci√≥n getListaCotizacionesResumen en el backend
            const datos = await ejecutarGAS('getListaCotizacionesResumen');
            datosCotizaciones = datos;
            renderizarTablaResumen(datos);
        } catch (error) {
            console.error("Error cargando datos:", error);
        }
    }
// === Variables Globales para Paginaci√≥n ===
let paginaActual = 1;
let filasPorPagina = 80; // Valor inicial
let datosFiltradosPaginacion = []; // Datos actualmente filtrados para paginar

// === MODIFICAR renderizarTablaResumen ===
function renderizarTablaResumen(datos) {
    // Guarda los datos completos (o filtrados) para paginar
    datosFiltradosPaginacion = datos || [];
    // Define filasPorPagina seg√∫n el selector
    const selectFilas = document.getElementById("filasPorPagina");
    filasPorPagina = parseInt(selectFilas.value) || 80;

    paginaActual = 1; // Resetear a la primera p√°gina cada vez que se renderiza (ej. al filtrar)

    mostrarPagina(paginaActual); // Muestra la primera p√°gina
}

// === NUEVA FUNCI√ìN para mostrar una p√°gina espec√≠fica ===
function mostrarPagina(numeroPagina) {
        const tbody = document.getElementById("cuerpoTablaResumen");
        tbody.innerHTML = "";

        const datosParaMostrar = datosFiltradosPaginacion;

        // --- Correcci√≥n: Validar si hay datos reales ---
        if (!datosParaMostrar || datosParaMostrar.length <= 1 || datosParaMostrar[1][0] === "Error") { // <= 1 por encabezado, o si el backend devolvi√≥ error
            const mensaje = (datosParaMostrar && datosParaMostrar.length > 1 && datosParaMostrar[1][0] === "Error") ? datosParaMostrar[1][2] : "No hay cotizaciones para mostrar.";
            tbody.innerHTML = crearFilaVacia(mensaje);
            actualizarControlesPaginacion(0);
            return;
        }
        // --- Fin Correcci√≥n ---


        paginaActual = numeroPagina;
        const totalFilasDatos = datosParaMostrar.length - 1;
        const indiceInicio = (paginaActual - 1) * filasPorPagina;
        const indiceFin = indiceInicio + filasPorPagina;
        const filasPagina = datosParaMostrar.slice(indiceInicio + 1, indiceFin + 1);

         if (filasPagina.length === 0 && paginaActual > 1) { /* ... ir a p√°g anterior ... */ }
         else if (filasPagina.length === 0 && paginaActual === 1) { /* ... mostrar fila vac√≠a ... */ }


        const scriptUrl = '<?!= getScriptUrl() ?>';

        filasPagina.forEach((fila) => {
            // Leer datos usando CONFIG actualizado
            const numPedido = fila[CONFIG.columnas.NUM_PEDIDO];
            const fecha = fila[CONFIG.columnas.FECHA];
            const cliente = fila[CONFIG.columnas.CLIENTE];
            const vendedor = fila[CONFIG.columnas.VENDEDOR]; // Nuevo
            const compania = fila[CONFIG.columnas.COMPANIA]; // Nuevo
            const monto = parseFloat(fila[CONFIG.columnas.MONTO]) || 0;
            const moneda = String(fila[CONFIG.columnas.MONEDA] || '').toUpperCase(); // Asegurar may√∫sculas
            const estado = fila[CONFIG.columnas.ESTADO];
            const rowIndexOriginal = fila[CONFIG.columnas.ROW_INDEX];

            if (!numPedido || typeof rowIndexOriginal !== 'number' || rowIndexOriginal < 2) return;

            // Formateo de Moneda
            const simboloMoneda = (moneda === 'SOL' || moneda === 'SOLES') ? 'S/ ' : '$ ';
            // Usar toLocaleString para formato de miles y decimales correcto
            const montoFormateado = simboloMoneda + monto.toLocaleString('es-PE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

            const tr = document.createElement("tr");
            // A√±adir nuevas celdas td
            tr.innerHTML = `
                <td>${escapeHtml(numPedido)}</td>
                <td>${escapeHtml(fecha)}</td>
                <td>${escapeHtml(cliente)}</td>
                <td>${escapeHtml(vendedor)}</td>      <td>${escapeHtml(compania)}</td>      <td class="monto-col">${montoFormateado}</td> <td>${escapeHtml(moneda)}</td>
                <td><span class="estado-${estado ? escapeHtml(estado.replace(/\s+/g, '-')) : 'Desconocido'}">${escapeHtml(estado || 'Desconocido')}</span></td>
                <td><button onclick="editarCotizacionSegura('${escapeHtml(numPedido)}')" class="btn-editar">‚úèÔ∏è Editar</button></td>
                <td style="text-align: center;"><button onclick="generarPDF(${rowIndexOriginal})" class="btn-pdf" data-row="${rowIndexOriginal}">üìÑ PDF</button></td>
            `;
            tbody.appendChild(tr);
        });

        actualizarControlesPaginacion(totalFilasDatos);
        console.log(`P√°gina ${paginaActual} renderizada...`); // Opcional
    }

// === NUEVA FUNCI√ìN para actualizar los controles de paginaci√≥n ===
function actualizarControlesPaginacion(totalFilasDatos) {
    const infoPagina = document.getElementById("infoPagina");
    const btnAnterior = document.getElementById("btnAnterior");
    const btnSiguiente = document.getElementById("btnSiguiente");

    const totalPaginas = Math.ceil(totalFilasDatos / filasPorPagina);

    if (totalFilasDatos === 0) {
        infoPagina.textContent = "0 resultados";
        btnAnterior.disabled = true;
        btnSiguiente.disabled = true;
    } else {
        const inicio = (paginaActual - 1) * filasPorPagina + 1;
        const fin = Math.min(inicio + filasPorPagina - 1, totalFilasDatos);
        infoPagina.textContent = `${inicio}-${fin} de ${totalFilasDatos}`;

        btnAnterior.disabled = (paginaActual === 1);
        btnSiguiente.disabled = (paginaActual === totalPaginas);
    }
}

// === NUEVA FUNCI√ìN para cambiar de p√°gina ===
function cambiarPagina(direccion) { // direccion es +1 (siguiente) o -1 (anterior)
    const nuevaPagina = paginaActual + direccion;
    const totalFilasDatos = datosFiltradosPaginacion.length - 1;
    const totalPaginas = Math.ceil(totalFilasDatos / filasPorPagina);

    // Validar l√≠mites
    if (nuevaPagina >= 1 && nuevaPagina <= totalPaginas) {
        mostrarPagina(nuevaPagina);
    }
}

 // === NUEVA FUNCI√ìN para cambiar filas por p√°gina ===
function cambiarFilasPorPagina() {
    const selectFilas = document.getElementById("filasPorPagina");
    filasPorPagina = parseInt(selectFilas.value) || 80;
    // Volver a mostrar la primera p√°gina con la nueva cantidad de filas
    mostrarPagina(1); 
}

// === MODIFICAR filtrarPedidos para usar paginaci√≥n ===
 function filtrarPedidos() {
    const filtro = document.getElementById("filtroPedidos").value.toLowerCase();

    let datosParaFiltrar = datosCotizaciones; // Siempre filtrar sobre los datos originales completos
    let datosFiltradosResultado = [datosParaFiltrar[0]]; // Mantener encabezados

    if (!filtro) {
        // Si no hay filtro, usar todos los datos
         datosFiltradosResultado = datosParaFiltrar;
    } else {
         // Aplicar filtro
        datosParaFiltrar.slice(1).forEach(fila => {
            const numPedido = String(fila[CONFIG.columnas.NUM_PEDIDO] || '').toLowerCase();
            const cliente = String(fila[CONFIG.columnas.CLIENTE] || '').toLowerCase();
            const estado = String(fila[CONFIG.columnas.ESTADO] || '').toLowerCase();

            if (numPedido.includes(filtro) || cliente.includes(filtro) || estado.includes(filtro)) {
                datosFiltradosResultado.push(fila);
            }
        });
    }

    // Llamar a renderizarTablaResumen con los datos filtrados (esta funci√≥n resetea a p√°g 1)
    renderizarTablaResumen(datosFiltradosResultado);
}

// Inicializar el selector de filas al cargar
 document.addEventListener("DOMContentLoaded", function() {
      const selectFilas = document.getElementById("filasPorPagina");
      selectFilas.value = filasPorPagina; // Asegurar que muestre 80 al inicio
 });

// === FIN C√ìDIGO PAGINACI√ìN ===

// ‚úÖ FUNCI√ìN AUXILIAR PARA ESCAPAR HTML
function escapeHtml(unsafe) {
    if (unsafe === null || unsafe === undefined) return '';
    return String(unsafe)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}

// =============================================================================
// FUNCI√ìN CORREGIDA PARA EDITAR COTIZACI√ìN
// =============================================================================
function editarCotizacion(scriptUrl, numPedido) {
    if (!numPedido) {
        console.error("‚ùå Error: numPedido no definido");
        alert("Error: No se puede editar, n√∫mero de pedido no disponible");
        return;
    }
    
    console.log("üìù Editando cotizaci√≥n:", numPedido);
    console.log("üîó Script URL:", scriptUrl);
    
    // ‚úÖ CONSTRUIR URL CORRECTAMENTE
    const url = `${scriptUrl}?page=Comercial&editar=${encodeURIComponent(numPedido)}`;
    
    console.log("üéØ URL final:", url);
    
    // ‚úÖ ABRIR EN LA MISMA VENTANA (no en nueva pesta√±a)
    window.top.location.href = url;
}

// ‚úÖ FUNCI√ìN AUXILIAR PARA DEBUG
function debugURL(scriptUrl, numPedido) {
    console.log("=== üîó DEBUG URL ===");
    console.log("Script URL:", scriptUrl);
    console.log("N√∫mero Pedido:", numPedido);
    console.log("URL construida:", `${scriptUrl}?page=Comercial&editar=${encodeURIComponent(numPedido)}`);
    console.log("=== FIN DEBUG ===");
}
    
    function crearFilaVacia(mensaje) {
        return `
            <tr>
                <td colspan="8" style="text-align: center; padding: 30px; color: #666;">
                    ${mensaje}
                </td>
            </tr>
        `;
    }

    function editarCotizacion(scriptUrl, numPedido) {
        const url = `${scriptUrl}?page=Comercial&editar=${encodeURIComponent(numPedido)}`;
        window.open(url, '_blank');
    }

    // =============================================================================
    // FUNCI√ìN PARA EDITAR COTIZACI√ìN - CORREGIDA
    // =============================================================================
    function editarCotizacion(scriptUrl, numPedido) {
        if (!numPedido) {
            console.error("‚ùå Error: numPedido no definido");
            alert("Error: No se puede editar, n√∫mero de pedido no disponible");
            return;
        }
    
        console.log("üìù Editando cotizaci√≥n:", numPedido);
        const url = `${scriptUrl}?page=Comercial&editar=${encodeURIComponent(numPedido)}`;
        console.log("üîó URL de edici√≥n:", url);
        window.open(url, '_blank');
    }

    // =============================================================================
    // FUNCIONES DE FILTRADO
    // =============================================================================

    function filtrarPedidos() {
        const filtro = document.getElementById("filtroPedidos").value.toLowerCase();
        
        if (!filtro) {
            renderizarTablaResumen(datosCotizaciones);
            return;
        }

        const datosFiltrados = [datosCotizaciones[0]]; // Mantener encabezados
        
        datosCotizaciones.slice(1).forEach(fila => {
            const numPedido = String(fila[CONFIG.columnas.NUM_PEDIDO] || '').toLowerCase();
            const cliente = String(fila[CONFIG.columnas.CLIENTE] || '').toLowerCase();
            const estado = String(fila[CONFIG.columnas.ESTADO] || '').toLowerCase();
            
            if (numPedido.includes(filtro) || cliente.includes(filtro) || estado.includes(filtro)) {
                datosFiltrados.push(fila);
            }
        });
        
        renderizarTablaResumen(datosFiltrados);
    }

    // =============================================================================
    // FUNCIONES DE ACCI√ìN
    // =============================================================================
    
    function abrirNuevoPedido() {
        navegarA('Comercial');
    }

    /**
     * Llama al servidor para generar el PDF del pedido y lo abre.
     * @param {number} rowIndex El √≠ndice de la fila del pedido a procesar (para el detalle completo).
     */
    function generarPDF(rowIndex) {
        if (!confirm(`¬øEst√°s seguro de que deseas generar el PDF para el pedido en la fila ${rowIndex}?`)) {
            return;
        }
        
        // 1. Mostrar mensaje de carga
        const btn = document.querySelector(`.btn-pdf[data-row='${rowIndex}']`);
        if(btn) {
            btn.disabled = true;
            btn.textContent = '‚è≥ Generando...';
        } else {
            alert('Generando PDF...');
        }

        google.script.run
            .withSuccessHandler(function(resultado) {
                if (resultado.success) {
                    // 2. Abrir el PDF en nueva pesta√±a
                    window.open(resultado.pdfUrl, '_blank');
                    alert('‚úÖ PDF generado exitosamente!');
                } else {
                    alert('‚ùå Error al generar PDF: ' + (resultado.error || resultado.message || 'Error desconocido'));
                }
                
                // 3. Restaurar bot√≥n
                if(btn) {
                    btn.disabled = false;
                    btn.textContent = 'üìÑ PDF';
                }
            })
            .withFailureHandler(function(error) {
                alert('‚ùå Error al conectar con el servidor: ' + error.message);
                // 3. Restaurar bot√≥n
                if(btn) {
                    btn.disabled = false;
                    btn.textContent = 'üìÑ PDF';
                }
            })
            .generarYDevolverPDF(rowIndex); // Llama a la funci√≥n de GS
    }

    function debugFrontend() {
        console.log("=== üêõ DEBUG FRONTEND ===");
        console.log("URL actual:", window.location.href);
        console.log("Script URL:", '<?!= getScriptUrl() ?>');
        console.log("Total cotizaciones cargadas (incl. encabezado):", datosCotizaciones.length);
        console.log("=== FIN DEBUG ===");
        
        alert("Debug ejecutado - Revisa la consola del navegador (F12)");
    }

    function mostrarLoading(mostrar, mensaje = "Cargando...") {
        const overlay = document.getElementById("loadingOverlay");
        const texto = document.getElementById("loadingText");
        
        if (overlay && texto) {
            overlay.style.display = mostrar ? "flex" : "none";
            texto.textContent = mensaje;
        }
    }

    function editarCotizacionSegura(numPedido) {
    if (!numPedido) {
        alert("Error: No se puede editar, n√∫mero de pedido no disponible");
        return;
    }
    
    console.log("üìù Guardando pedido para edici√≥n:", numPedido);
    
    // Guardar en sessionStorage
    sessionStorage.setItem('pedidoAEditar', numPedido);
    
    // Navegar a Comercial
    const url = '<?!= getScriptUrl() ?>?page=Comercial';
    console.log("üîó Navegando a:", url);
    window.top.location.href = url;
}

// === Variables Globales para Ordenaci√≥n ===
let columnaOrden = -1; // Columna actualmente ordenada (-1 = ninguna)
let direccionOrden = 'asc'; // 'asc' o 'desc'

/**
 * Ordena la tabla de cotizaciones por la columna especificada.
 * @param {number} indiceColumna - El √≠ndice de la columna (0, 1, 2...).
 * @param {string} tipoDato - 'texto', 'numero' o 'fecha'.
 */
function ordenarTabla(indiceColumna, tipoDato) {
    console.log(`Ordenando por columna ${indiceColumna}, tipo ${tipoDato}`);
    const tbody = document.getElementById("cuerpoTablaResumen");
    // Convertir filas HTML a un array de arrays para poder ordenar
    const filasArray = Array.from(tbody.querySelectorAll("tr"));

    // Determinar nueva direcci√≥n de orden
    if (indiceColumna === columnaOrden) {
        direccionOrden = (direccionOrden === 'asc') ? 'desc' : 'asc';
    } else {
        columnaOrden = indiceColumna;
        direccionOrden = 'asc'; // Por defecto ascendente al cambiar de columna
    }

    // Funci√≥n de comparaci√≥n
    const compararFilas = (filaA, filaB) => {
        const valorA = filaA.cells[indiceColumna].textContent || filaA.cells[indiceColumna].innerText;
        const valorB = filaB.cells[indiceColumna].textContent || filaB.cells[indiceColumna].innerText;

        let comparacion = 0;

        switch (tipoDato) {
            case 'numero':
                // Extraer solo n√∫meros y punto decimal
                const numA = parseFloat(valorA.replace(/[^0-9.-]+/g,""));
                const numB = parseFloat(valorB.replace(/[^0-9.-]+/g,""));
                comparacion = (isNaN(numA) ? 0 : numA) - (isNaN(numB) ? 0 : numB);
                break;
            case 'fecha':
                // Asumir formato DD/MM/AAAA y convertir a objeto Date para comparar
                try {
                    const partesA = valorA.split('/');
                    const partesB = valorB.split('/');
                    // Formato: AAAA, MM-1, DD
                    const fechaA = new Date(partesA[2], partesA[1] - 1, partesA[0]);
                    const fechaB = new Date(partesB[2], partesB[1] - 1, partesB[0]);
                    comparacion = fechaA - fechaB;
                } catch (e) {
                    console.warn("Error parseando fecha:", valorA, valorB);
                    comparacion = valorA.localeCompare(valorB, 'es', { sensitivity: 'base' }); // Fallback a texto
                }
                break;
            case 'texto':
            default:
                comparacion = valorA.localeCompare(valorB, 'es', { sensitivity: 'base' }); // Comparaci√≥n de texto insensible a may√∫sculas/acentos
                break;
        }

        return (direccionOrden === 'asc') ? comparacion : -comparacion;
    };

    // Ordenar el array de filas
    filasArray.sort(compararFilas);

    // Limpiar tbody
    tbody.innerHTML = "";

    // Volver a a√±adir las filas ordenadas
    filasArray.forEach(fila => tbody.appendChild(fila));

    // Actualizar iconos visuales en encabezados
    actualizarIconosOrden(indiceColumna, direccionOrden);
}

/**
 * Actualiza los iconos de flecha en los encabezados de la tabla.
 */
function actualizarIconosOrden(indiceColumnaActiva, direccion) {
    const encabezados = document.querySelectorAll("#tablaResumen th .sort-icon");
    encabezados.forEach((icono, index) => {
        icono.classList.remove('asc', 'desc');
        icono.style.opacity = '0.4'; // Resetear opacidad
        // El √≠ndice del icono puede no coincidir directamente si hay TH no ordenables
        // Buscamos el √≠ndice correcto basado en el TH padre
        const thPadre = icono.closest('th');
        if (thPadre && thPadre.cellIndex === indiceColumnaActiva) {
            icono.classList.add(direccion);
            icono.style.opacity = '1'; // Hacer visible el icono activo
        }
    });
}

// === FIN C√ìDIGO ORDENACI√ìN ===

</script>
</body>
</html>
